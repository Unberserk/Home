<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Berserk</title>
  <link rel="icon" type="image/png" href="./Assests/Imgs/Logo.png" />
  <link rel="stylesheet" type="text/css" href="./Assests/CSS/main.css" />
  <link rel="stylesheet" type="text/css" href="./Assests/CSS/f.css" />
  <link rel="stylesheet" type="text/css" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css" />
</head>
<body class="default">

  <nav class="Navigation">
    <div class="Navigation-Container">
      <a class="Navigation-Image" href="./"><img src="./Assests/Imgs/Logo.png" /></a>
      <ul>
        <li class="Navigation-Button"><a href="./"><i class="las la-home"></i><p>Home</p></a></li>
        <li class="Navigation-Button"><a href="./g.html"><i class="las la-file"></i><p>Projects</p></a></li>
        <li class="Navigation-Button"><a href="./u.html"><i class="las la-file"></i><p>Cinema</p></a></li>
        <li class="Navigation-Button"><a href="./d.html"><i class="las la-file"></i><p>Downloads</p></a></li>
        <li class="Navigation-Button"><a href="./f.html"><i class="las la-file"></i><p>Links</p></a></li>
        <li class="Navigation-Button"><a href="./e.html"><i class="las la-hourglass-half"></i><p>Emulator</p></a></li>
        <li class="Navigation-Button"><a href="./settings.html"><i class="las la-cog"></i><p>Settings</p></a></li>
      </ul>
    </div>
  </nav>

  <div class="container">
    <div class="input-section">
      <label for="link-input">Enter Link:</label>
      <input type="text" id="link-input" class="input-field" placeholder="Enter Link" />

      <label for="title-input">Enter Title:</label>
      <input type="text" id="title-input" class="input-field" placeholder="Enter Title" />

      <label>Choose Image (URL or File):</label>
      <input type="text" id="image-url-input" class="input-field" placeholder="Enter Image URL" />
      <input type="file" id="image-file-input" class="input-file" accept="image/*" />

      <button class="add-link-btn" onclick="addLink()">Add Link</button>

      <label for="file-input">Import Links from TXT or HTML:</label>
      <input type="file" id="file-input" accept=".txt,.html" class="input-file" />
      <button class="import-link-btn" onclick="importLinks()">Import Links</button>
      <button class="remove-all-btn" onclick="removeAllLinks()">Remove All Links</button>
      <button class="sort-btn" onclick="sortLinks()">Sort A-Z</button>
    </div>

    <div id="link-container" class="link-container"></div>
  </div>

  <div class="iframeContainer" style="display: none;">
    <button onclick="closeIframe()" class="closeIframeBtn">X</button>
    <iframe id="iframeLink" src="" width="100%" height="600" frameborder="0" allowfullscreen></iframe>
  </div>

  <script>
    const linkContainer = document.getElementById("link-container");

    function saveLinks(links) {
      localStorage.setItem("myLinks", JSON.stringify(links));
    }

    function getLinks() {
      return JSON.parse(localStorage.getItem("myLinks") || "[]");
    }

    function renderLinks() {
      const links = getLinks();
      linkContainer.innerHTML = "";
      links.forEach((link, index) => {
        const card = document.createElement("div");
        card.className = "link-card";
        card.innerHTML = `
          <img src="${link.image}" alt="Thumbnail" onerror="this.src='./Assests/Imgs/Logo.png'">
          <div class="link-info">
            <h3>${link.title}</h3>
            <button onclick="openIframe('${link.url}')">Open</button>
            <button onclick="deleteLink(${index})">Delete</button>
          </div>
        `;
        linkContainer.appendChild(card);
      });
    }

    function addLink() {
      const url = document.getElementById("link-input").value.trim();
      const title = document.getElementById("title-input").value.trim();
      const imageUrl = document.getElementById("image-url-input").value.trim();
      const fileInput = document.getElementById("image-file-input");

      if (!url || !title) return alert("Please enter a title and link");

      let image = imageUrl;
      if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.onload = function (e) {
          image = e.target.result;
          saveNewLink(url, title, image);
        };
        reader.readAsDataURL(file);
      } else {
        saveNewLink(url, title, image);
      }
    }

    function saveNewLink(url, title, image) {
      const links = getLinks();
      links.push({ url, title, image });
      saveLinks(links);
      renderLinks();
      document.getElementById("link-input").value = "";
      document.getElementById("title-input").value = "";
      document.getElementById("image-url-input").value = "";
      document.getElementById("image-file-input").value = "";
    }

    function deleteLink(index) {
      const links = getLinks();
      links.splice(index, 1);
      saveLinks(links);
      renderLinks();
    }

    function removeAllLinks() {
      if (confirm("Are you sure you want to delete all links?")) {
        localStorage.removeItem("myLinks");
        renderLinks();
      }
    }

    function openIframe(url) {
      document.querySelector(".iframeContainer").style.display = "block";
      document.getElementById("iframeLink").src = url.startsWith("http") ? url : "https://" + url;
    }

    function closeIframe() {
      document.querySelector(".iframeContainer").style.display = "none";
      document.getElementById("iframeLink").src = "";
    }

    function importLinks() {
      const fileInput = document.getElementById("file-input");
      const file = fileInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (e) {
        const content = e.target.result;
        const links = getLinks();

        if (file.name.endsWith(".html")) {
          const doc = new DOMParser().parseFromString(content, "text/html");
          const anchors = [...doc.querySelectorAll("a")];
          anchors.forEach(a => {
            links.push({ url: a.href, title: a.textContent, image: "./Assests/Imgs/Logo.png" });
          });
        } else if (file.name.endsWith(".txt")) {
          const lines = content.split("\n");
          lines.forEach(line => {
            const [title, url] = line.split(",");
            if (url && title) {
              links.push({ url: url.trim(), title: title.trim(), image: "./Assests/Imgs/Logo.png" });
            }
          });
        }

        saveLinks(links);
        renderLinks();
      };
      reader.readAsText(file);
    }

    function sortLinks() {
      const links = getLinks();
      links.sort((a, b) => a.title.localeCompare(b.title));
      saveLinks(links);
      renderLinks();
    }

    window.onload = renderLinks;
  </script>

</body>
</html>
